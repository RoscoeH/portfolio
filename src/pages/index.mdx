---
---

import theme from "../gatsby-plugin-theme-ui"
export const NUM_PROJECTS = 6

<SiteMetaData>
  {({ description }) => (
    <Box sx={{ bg: "muted", p: 3, borderRadius: 4 }}>{description}</Box>
  )}
</SiteMetaData>

<Divider />

<Flex sx={{ justifyContent: "space-between", alignItems: "center", mb: 3 }}>
  <Heading variant="styles.h2" mb="0">
    Projects
  </Heading>
  <Link variant="heading" href="/projects/">
    View All
  </Link>
</Flex>

<SourceList filter="projects">
  {projects => (
    <Grid columns={[1, null, null, null, 2, null, 3]}>
      {projects
        .slice(0, NUM_PROJECTS)
        .map(({ node: { frontmatter, fields } }, index) => {
          const {
            title,
            subtitle,
            description,
            links,
            featuredImage,
          } = frontmatter
          const { slug } = fields
          return (
            <Card key={title}>
              <Flex sx={{ flexDirection: "column", height: "100%" }}>
                <Flex mb="3">
                  {featuredImage && (
                    <Img
                      fixed={featuredImage.childImageSharp.fixed}
                      alt={`${title} icon`}
                      imgStyle={{ borderRadius: theme.radii[3] }}
                    />
                  )}
                  <Box ml="3">
                    <Link href={slug} variant="title">
                      {title}
                    </Link>
                    <br />
                    <Text>{subtitle}</Text>
                  </Box>
                </Flex>
                <Text sx={{ flex: "1 1 auto" }}>{description}</Text>
                <Box
                  sx={{
                    mt: 3,
                    textAlign: "right",
                    "& > :not(:last-child)": { mr: 2 },
                  }}
                >
                  <Link variant="button" href={links.site}>
                    <Icon icon="external" />
                    Visit Site
                  </Link>
                  <Link variant="button" href={slug}>
                    <Icon icon="eye" />
                    View Project
                  </Link>
                </Box>
              </Flex>
            </Card>
          )
        })}
    </Grid>
  )}
</SourceList>

<Divider />

<Heading variant="styles.h2">Links</Heading>

<SiteMetaData>
  {({ links }) => (
    <Grid columns={2} gap={2}>
      {links.map(({ name, url, icon }) => (
        <Link variant="button">
          <Icon icon={icon} />
          {name}
        </Link>
      ))}
    </Grid>
  )}
</SiteMetaData>

<Divider />

<Heading variant="styles.h2">Contact</Heading>
<Box as="form" sx={{ textAlign: "right" }} onSubmit={e => e.preventDefault()}>
  <Label htmlFor="name">Name</Label>
  <Input id="name" name="name" />
  <Label htmlFor="email">Email</Label>
  <Input id="email" name="email" />
  <Label htmlFor="message">Message</Label>
  <Textarea id="message" name="message" rows={6} />
  <Button sx={{ width: "100%" }}>
    <Icon icon="email" />
    Send
  </Button>
</Box>
